<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extended TO-DO App</title>
    <link rel="stylesheet" type="text/css" href="xtoDoApp.css">
    <link rel="icon" type="text/x-icon" href="../../LCO.png">

</head>
<body>
    <h1> TODO App </h1><sub>v 2.0 - Using local Storage <strong>(Refresh to see)</strong></sub>
    <form>
        <div id="control-center">
            <input type="text" id="inputValue" placeholder="Write Something!">
            <button class="btn">SUBMIT</button>
        </div>
        <section id="todo-lists-elem"></section>
    </form>
    <script>
        let mainTodoElem = document.getElementById("todo-lists-elem");
        let inputValue = document.getElementById("inputValue");


        const getTodoListFromLocal = () => {
            return JSON.parse(localStorage.getItem("Key"));
        };

        // REMOVING SECTION - CODE
        const toDoElementOfLocalStorage = (localToDoLists) => {
            return localStorage.setItem("Key", JSON.stringify(localToDoLists));
        };

        // We are using FAT ARROW FUNC SO CONDITION WILL BE WRITTEN BELOW (HOSTING)
        let localToDoLists = getTodoListFromLocal() || [];

        //Adding data from localStorage AND LOOPING IT TO DISPLAY ITEMS
        const displayToDoDynamically = (curElem) => {

            const divElement = document.createElement("div");
            divElement.classList.add("main-todo-div");
            divElement.innerHTML = `<li>${curElem}</li> <button class="deleteBtn"> Delete </button>`;
            mainTodoElem.append(divElement);
        };

        const addToDoLists = () => {
            event.preventDefault();

            const toDoListValue = inputValue.value.trim();

            // Auto Remove the placeholder value
            inputValue.value = "";

            if(toDoListValue !== "" && !(localToDoLists.includes(toDoListValue))){
            // Pushing Value in an Array
            localToDoLists.push(toDoListValue);

            // To Add unique values in our lists
            localToDoLists = [...new Set(localToDoLists)];

            console.log(localToDoLists);

            // storing values in local storage 
            // Using JSON.stringify to convert ARRAY into STRING
            localStorage.setItem("Key" , JSON.stringify(localToDoLists));

            displayToDoDynamically(toDoListValue);
          }
          else{
            alert("Please Write Something! ");
          }
        };

        const showToDoList = () => {
            console.log(localToDoLists);

            localToDoLists.forEach((curElem) => {
                displayToDoDynamically(curElem);
            });
        };

        // First We Show Data Then Try to Remove
        showToDoList();

        //REMOVING TODO ELEMENT
        const removeToDo = (event) => {
            //console.log(event.target);
            const removeToDo = event.target;
            let toDoListContent = removeToDo.previousElementSibling.textContent;
            let parentElem = removeToDo.parentElement;
            console.log(toDoListContent);
             
            localToDoLists = localToDoLists.filter((curElem) => {
                return curElem !== toDoListContent;
            });

            toDoElementOfLocalStorage(localToDoLists);

             parentElem.remove();

             console.log(localToDoLists);
        };

        // WHEN WE WANT TO DELETE AN ELEMENT
        mainTodoElem.addEventListener('click', (event) => {
        event.preventDefault();
        if (event.target.classList.contains("deleteBtn")) {
            removeToDo(event);
        }
        })

        // WE CALL A FUNCTION - WHEN WE CLICK ON THE BUTTON
        document.querySelector(".btn").addEventListener('click', (event) => {
            addToDoLists(event);
        })

    </script>
    <!-- //`` -->
</body>
</html>